## Concurrency Programming (동시성 프로그래밍)

- 동시성 프로그래밍은 멀티 스레드 환경에서 여러 가지 작업을 동시에 처리하는 기술을 말한다.
- 동시성이란 같은 시간에 여러가지 일이 일어나는 것을 뜻한다.

- 여러 프로그램을 병렬로 실행하는 것은 대부분 백그라운드에서 이루어지며, 프로세서의 시간을 거의 사용하지 않는다.

- 과거에는 애플리케이션에 동시성을 도입하려면 개발자가 직접 하나 이상의 추가 스레드를 생성해야 했다. 스레드 코드를 작성하는 것은 어려운 일이고, 설계의 복잡성과 위험성을 갖게 된다.

- 애플리케이션이 다중 코어를 사용하는 기존 방식은 다중 스레드를 생성하는 것이다. 하지만 기술이 발전하여 CPU의 코어 수가 증가함에 따라 스레드 코드가 임의의 수의 코어로 잘 확장되지 않는다. 이를 해결하기 위해 다중 코어를 활용할 수 있는 방법이 필요하다.



![image](https://user-images.githubusercontent.com/88870642/224009801-14e14f7b-da64-43d8-ba6b-ea5d53a8f90b.png)

### 코어

- 코어는 CPU의 핵심으로 CPU에서 실제로 일을 처리해주는 친구이다. 즉, 코어가 많다는 것은 작업을 처리할 친구들이 많아진다는 것이다.

- 코어는 시간의 흐름에 있어 한번에 한가지 일만 처리할 수 있다.
- 코어를 요리사로 빗대보면 "코어 한개 = 요리사 한명"이고 요리사가 음식 여러개를 번갈아 조리하는 장면을 생각하면 코어 한개로 여러 작업을 하는것을 설명할 수 있다.
- 코어가 여러개면 요리사가 여러명이라는 것이다.
- 코어가 여러가지 일을 번갈아 가며 처리하는 것을 동시성 프로그래밍이라고 한다. 



### 스레드

- 하드웨어에서의 스레드와 소프트웨어에서의 스레드로 구분이 된다. 





## Process VS Thread

###  프로세스란?



\- 단순히 실행 중인 프로그램이라고 할 수 있다.

\- 운영체제로부터 자원을 할당받는 작업의 단위

\- 즉, 사용자가 작성한 프로그램이 운영체제에 의해 메모리 공간을 할당받아 실행 중인 것을 말한다.

\- 프로세스 프로그램의 데이터와 메모리, 스레드로 구성된다.



### 스레드란?

- 우리가 주로 다룰 것은 소프트웨어에서의 스레드이며, 프로세스 내부에서의 작업 단위가 되는 가상의 스레드이다. 
- 하나의 스레드가 모든 작업을 처리하는 것보다 여러 개의 스레드에 분산시켜 작업을 처리하는 것이 효율적이다.

- 동시성 프로그래밍이란 소프트웨어에서의 멀티 스레딩 기술을 이용한 것이다.

- 모든 프로세스에는 한 개 이상의 스레드가 존재하여 작업을 수행한다.

  

🔥🔥프로세스는 하나의 프로그램이고 스레드는 그 안에서 이루어지는 동작들 하나하나를 뜻하는 걸까?



### 병렬 프로그래밍 

- 여러 개의 CPU(코어)가 하나의 작업(Task)을 분담해서 처리한다.
- 아주 큰 영상, 그래픽 또는 머신 러닝에서는 매우 빠르고 많은 작업량을 처리해야 하기에 병렬 프로그래밍을 사용한다. 



### 동시성 프로그래밍

- 동시성 프로그래밍은 하나의 CPU가 여러 작업을 동시에 처리해야 한다.
- 동시성 프로그래밍은 병렬 프로그래밍과 달리 싱글 코어에서도 가능한 논리적인 개념이다.
- 하나의 작업만 처리하는 환경(코어가 하나)에서 논리적으로 여러 일을 동시에 처리하기 때문이다.
- 여러가지 작업을 나열해두고, 하나씩, 조금씩 번갈아가면서 작업을 처리하는데, 속도가 매우 빨라서 동시에 작업하는 것처럼 느껴진다.
- 다중 스레드를 사용한다.



🔥🔥 병렬 프로그래밍과 동시성 프로그래밍은 반대되는 개념이 아니다!!



### 직렬성 프로그래밍

- 동시성 프로그래밍과 반대로 하나의 스레드에서 작업을 하는 것으로, 동시에 작업을 처리하지 못하고, 순서대로 작업을 처리해야 한다. 



### 동기

- 프로그램 작업이 끝나기를 기다리는 것이다.



### 비동기

- 프로그래밍이  끝나는 것을 기다리지 않고, 다음 코드 블록을 바로 실행시키는 코드이다.

- 동시성: Serial이냐, Concurrent이냐, 단일 스레드인가, 다중 스레드인가
- 동기 / 비동기 : 스레드의 수와는 무관하게 작업이 끝나기를 기다리느냐, 기다리지 않느냐



### 동시성 프로그래밍은 왜 필요할까?

1. 효율적으로 동작하는 소프트웨어
   - 동시성 프로그래밍을 사용하지 않으면 모든 일을 하나의 스레드에서 담당하게 된다. 동시성 프로그래밍을 하게 되면 소프트웨어가 더 쾌적하고 효율적으로 동작할 수 있게 해준다.
2. 사용성, 반응성이 좋은 소프트웨어 
   - 효율적으로 동작한다는 이점은 결국 사용성, 반응성이 좋아지는 것으로 귀결된다. 사용성이 좋고 반응성이 좋은 것은 무엇을 뜻하냐면, 사용자가 앱을 실행하는 동안 끊김 없이 최적화된 앱을 사용할 수 있다는 것이다.



## GCD(Grand Central Dispatch)

- 개발자가 일일이 스레드를 관리하지 않게끔, 애플에서는 코드로서 동기/비동기 처리만 해준다면 시스템이 알아서 스레드를 관리해주는 방식을 제공하는데, 이것이 바로 GCD이다.
- GCD는 멀티코어 시스템에서 동시성 실행을 제공하는 프로그래밍 언어 요소, 런타임 라이브러리 등이다.
-  GCD를 사용하기 위해서 Dispatch라는 프레임워크를, 그 중에서도 특히 Dispatch Queue라는 클래스를 주로 사용하게 될 것이다.

-  작업을 비동기적으로 시작하는 기술 중 하나이다.

- 실행할 작업을 정의하고 적절한 디스패치 큐에 추가하면, GCD는 필요한 스레드를 생성하고 해당 스레드에서 실행되도록 작업을 예약한다.



## Dispatch Queues	

\- 원래는 개발자가 스레드 코드를 직접 작성하는 방식이였지만 Dispatch Queue를 통해 개발자는 작업을 Dispatch Queue에 넣어주기만 하면, 스레드에 작업을 분배해준다.

\- Dispatch Queues는 FIFO(선입선출 / 큐의 형태)를 띄고 있다.

\- Serial Dispatch Queue는 한번에 하나의 작업을 실행하고 작업이 완료될 때까지 기다렸다가 대기열에서 빼서 시작한다.

\- Concurrent Dispatch Queue는 하나의 작업이 끝나지 않아도 다른 작업을 시작할 수 있다.





## 참고 

- [Apple developer - 동시성 프로그래밍](https://developer.apple.com/library/archive/documentation/General/Conceptual/ConcurrencyProgrammingGuide/ConcurrencyandApplicationDesign/ConcurrencyandApplicationDesign.html#//apple_ref/doc/uid/TP40008091-CH100-SW1)
- [야곰닷넷 - 동시성 프로그래밍](https://yagom.net/courses/%eb%8f%99%ec%8b%9c%ec%84%b1-%ed%94%84%eb%a1%9c%ea%b7%b8%eb%9e%98%eb%b0%8d-concurrency-programming/)

